<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>jupyter-kernal on Wang Fenjin</title><link>https://www.wangfenjin.com/tags/jupyter-kernal/</link><description>Recent content in jupyter-kernal on Wang Fenjin</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Copyright © 2021 Wang Fenjin :: Powered by &lt;a href="http://gohugo.io">Hugo&lt;/a></copyright><lastBuildDate>Sun, 28 Jun 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://www.wangfenjin.com/tags/jupyter-kernal/index.xml" rel="self" type="application/rss+xml"/><item><title>xeus-clickhouse: Jupyter 的 ClickHouse 内核</title><link>https://www.wangfenjin.com/posts/jupyter-clickhouse/</link><pubDate>Sun, 28 Jun 2020 00:00:00 +0000</pubDate><guid>https://www.wangfenjin.com/posts/jupyter-clickhouse/</guid><description>在科学计算领域，Jupyter 是一个使用非常广泛的集成开发环境，它支持多种主流的编程语言比如 Python, C++, R 或者 Julia。同时，数据科学最重要的还是数据，而 SQL 是操作数据最直观的语言。前段时间看到一篇文章，有人给 sqlite 做了一个 jupyter 的内核，感觉很有意思。所以我尝试给 ClickHouse 做了一个 jupyter 的内核，目前已经有了一个可以试用的版本，下面做一个简单介绍。
现状 新内核允许用户用 ClickHouse SQL 的语法直接操作远程 CH 数据库，通过一些扩展操作比如 %CONNECT 支持与 ch cli 一样的连接参数，后续也有计划使用 jupyter magics 支持更多的数据可视化操作。
项目参考了 jupyter sqlite 内核的实现方式，是基于 xeus 框架来实现的。xeus 是一个 c++ 的 lib 库，它对 jupyter 的内核做了很好的封装，我们只需要专注于内核相关的功能就可以了。目前对于 ch 的操作基于 clickhouse-cpp 来实现，它是 ch 的 cpp 客户端。
目前实现处于早期阶段，但是基础功能已经可用。它支持了几乎 CH 所有 SQL 语法，具体例子可以参考 clickhouse.ipynb。xeus-clickhouse 在 jupyter notebook 和 jupyter lab 中以 HTML 表格的形式展示数据；在 jupyter console 中，我们使用 tabulate 库只做纯文本的表格。</description><content>&lt;p>在科学计算领域，Jupyter 是一个使用非常广泛的集成开发环境，它支持多种主流的编程语言比如 Python, C++, R 或者 Julia。同时，数据科学最重要的还是数据，而 SQL 是操作数据最直观的语言。前段时间看到&lt;a href="https://blog.jupyter.org/a-jupyter-kernel-for-sqlite-9549c5dcf551">一篇文章&lt;/a>，有人给 sqlite 做了一个 jupyter 的内核，感觉很有意思。所以我尝试给 ClickHouse 做了一个 jupyter 的内核，目前已经有了一个可以试用的版本，下面做一个简单介绍。&lt;/p>
&lt;h2 id="现状">现状&lt;/h2>
&lt;p>新内核允许用户用 ClickHouse SQL 的语法直接操作远程 CH 数据库，通过一些扩展操作比如 &lt;code>%CONNECT&lt;/code> 支持与 ch cli 一样的连接参数，后续也有计划使用 jupyter magics 支持更多的数据可视化操作。&lt;/p>
&lt;p>项目参考了 jupyter sqlite 内核的实现方式，是基于 &lt;a href="https://github.com/jupyter-xeus/xeus">xeus&lt;/a> 框架来实现的。xeus 是一个 c++ 的 lib 库，它对 jupyter 的内核做了很好的封装，我们只需要专注于内核相关的功能就可以了。目前对于 ch 的操作基于 clickhouse-cpp 来实现，它是 ch 的 cpp 客户端。&lt;/p>
&lt;p>&lt;img src="https://www.wangfenjin.com/img/ch-sql.gif" alt="ch-sql">&lt;/p>
&lt;p>目前实现处于早期阶段，但是基础功能已经可用。它支持了几乎 CH 所有 SQL 语法，具体例子可以参考 &lt;a href="https://github.com/wangfenjin/xeus-clickhouse/blob/master/examples/clickhouse.ipynb">clickhouse.ipynb&lt;/a>。xeus-clickhouse 在 jupyter notebook 和 jupyter lab 中以 HTML 表格的形式展示数据；在 jupyter console 中，我们使用 tabulate 库只做纯文本的表格。&lt;/p>
&lt;h2 id="未来">未来&lt;/h2>
&lt;p>对于 xeus-clickhouse 未来的规划是，先打磨好稳定性，目前已知的还有一个非法字符导致内核崩溃的问题，已经提交 issue 给 xeus 仓库；另外clickhouse-cpp 不支持 ssl 连接。除了基础功能的打磨，还计划通过支持更多的 jupyter magic 来实现数据的可视化渲染，提供更方便的数据可视化能力。&lt;/p>
&lt;h2 id="使用">使用&lt;/h2>
&lt;p>我制作了一个 Docker 镜像发布在 &lt;a href="https://hub.docker.com/r/wangfenjin/xeus-clickhouse">docker-hub&lt;/a>，不需要安装任何环境就可以试用：&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#75715e"># start jupyter with clickhouse kernal&lt;/span>
docker run -p 8888:8888 wangfenjin/xeus-clickhouse:v0.1.0
&lt;span style="color:#75715e"># start a local clickhouse for testing&lt;/span>
docker run -d --name jupyter-clickhouse-server -p 8123:8123 --ulimit nofile&lt;span style="color:#f92672">=&lt;/span>262144:262144 yandex/clickhouse-server
&lt;span style="color:#75715e"># open the example/clickhouse.ipynb and connect to local server by&lt;/span>
&lt;span style="color:#75715e"># %CONNECT --host host.docker.internal --port 8123&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>在 docker 里面连接另外一个 docker 中的 ch 可能会有问题，感觉是目前 clickhouse-cpp 对于网络的处理不太完善。感兴趣的同学也可以下载代码自己编译，具体的编译流程见 &lt;a href="https://github.com/wangfenjin/xeus-clickhouse">github&lt;/a> 仓库。欢迎大家试用！&lt;/p></content></item></channel></rss>